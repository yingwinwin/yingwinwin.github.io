(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{181:function(n,e,t){"use strict";t.r(e),t.d(e,"frontMatter",(function(){return l})),t.d(e,"metadata",(function(){return i})),t.d(e,"toc",(function(){return b})),t.d(e,"default",(function(){return u}));var r=t(3),a=t(7),c=(t(0),t(187)),o=["components"],l={id:"callback",title:"callback",slug:"/FE/javaSciprt/callback"},i={unversionedId:"FE/javaSciprt/async/callback",id:"FE/javaSciprt/async/callback",isDocsHomePage:!1,title:"callback",description:"\u9ad8\u9636\u51fd\u6570",source:"@site/docs/FE/javaSciprt/async/callback.md",slug:"/FE/javaSciprt/callback",permalink:"/docs/FE/javaSciprt/callback",editUrl:"https://github.com/yingwinwin/yingwinwin.github.io/tree/master/docs/FE/javaSciprt/async/callback.md",version:"current",sidebar:"javaSciprt",previous:{title:"JavaScirpt",permalink:"/docs/FE/javaSciprt"},next:{title:"Promise",permalink:"/docs/FE/javaSciprt/promise"}},b=[{value:"\u9ad8\u9636\u51fd\u6570",id:"\u9ad8\u9636\u51fd\u6570",children:[{value:"\u6269\u5c55\u51fd\u6570",id:"\u6269\u5c55\u51fd\u6570",children:[]},{value:"\u67ef\u91cc\u5316",id:"\u67ef\u91cc\u5316",children:[]},{value:"\u53cd\u67ef\u91cc\u5316",id:"\u53cd\u67ef\u91cc\u5316",children:[]}]},{value:"\u56de\u8c03\u51fd\u6570",id:"\u56de\u8c03\u51fd\u6570",children:[{value:"\u540c\u6b65\u56de\u8c03\u51fd\u6570",id:"\u540c\u6b65\u56de\u8c03\u51fd\u6570",children:[]},{value:"\u5f02\u6b65\u56de\u8c03\u51fd\u6570",id:"\u5f02\u6b65\u56de\u8c03\u51fd\u6570",children:[]}]},{value:"\u5e76\u53d1",id:"\u5e76\u53d1",children:[{value:"after\u51fd\u6570",id:"after\u51fd\u6570",children:[]},{value:"\u53d1\u5e03\u8ba2\u9605",id:"\u53d1\u5e03\u8ba2\u9605",children:[]}]},{value:"\u5176\u4ed6",id:"\u5176\u4ed6",children:[{value:"\u89c2\u5bdf\u8005\u6a21\u5f0f",id:"\u89c2\u5bdf\u8005\u6a21\u5f0f",children:[]}]}],s={toc:b};function u(n){var e=n.components,t=Object(a.a)(n,o);return Object(c.b)("wrapper",Object(r.a)({},s,t,{components:e,mdxType:"MDXLayout"}),Object(c.b)("h2",{id:"\u9ad8\u9636\u51fd\u6570"},"\u9ad8\u9636\u51fd\u6570"),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"\u4f20\u5165\u51fd\u6570\uff0c\u6216\u8005\u8fd4\u56de\u51fd\u6570\uff0c\u5c31\u662f\u9ad8\u9636\u51fd\u6570")),Object(c.b)("h3",{id:"\u6269\u5c55\u51fd\u6570"},"\u6269\u5c55\u51fd\u6570"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-js"},"function core(...arg) {\n    console.log('core', ...arg);\n}\ncore.before = function (fn) {\n    // \u5728\u5916\u9762\u5305\u4e86\u4e00\u5c42\u51fd\u6570\u3002\u7528\u4e8e\u62d3\u5c55\n    return (...arg) => {\n        fn();\n        this(...arg)\n    }\n}\nlet before = core.before(() => {\n    console.log('before')\n})\nbefore('1')  // before, core, 1, \n")),Object(c.b)("h3",{id:"\u67ef\u91cc\u5316"},"\u67ef\u91cc\u5316"),Object(c.b)("p",null,"\u628a\u51fd\u6570\u7684\u4f5c\u7528\u8303\u56f4\u53d8\u5c0f"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-js"},"function sum(a, b, c, d, e, f, g) {\n  return a + b + c + d + e + f + g;\n}\n\nfunction currying(fn) {\n    const len = fn.length;  // \u5f53\u524d\u4f20\u5165\u7684\u67ef\u91cc\u5316\u51fd\u6570\u7684\u53c2\u6570\u957f\u5ea6\n    const persetArgs = Array.from(arguments).slice(1);  // \u9884\u8bbe\u7684\u53c2\u6570\u957f\u5ea6\n    return (...args) => {  // \u5f53\u524d\u4f20\u5165\u7684\u53c2\u6570\n        const allArgs = [...persetArgs, ...args];  // \u653e\u5230\u4e00\u8d77\n        if (allArgs.length >= len) { // \u5982\u679c\u957f\u5ea6\u5927\u4e8e\u6216\u8005\u7b49\u4e8e\u5f53\u524d\u957f\u5ea6\uff0c\u76f4\u63a5\u8c03\u7528\u8fd4\u56de\u7ed3\u679c\n            return fn(...allArgs);\n        } else {\n            return currying(fn, ...allArgs)  // \u5426\u5219\u9012\u5f52\uff0c\u8fd4\u56de\u4e00\u4e2a\u65b0\u51fd\u6570\n        }\n    }\n}\n\nlet numSum = currying(sum, 1, 2);\nconsole.log(numSum(3,4)(5)(6)(7))  // 28\n")),Object(c.b)("h3",{id:"\u53cd\u67ef\u91cc\u5316"},"\u53cd\u67ef\u91cc\u5316"),Object(c.b)("p",null,"\u628a\u51fd\u6570\u7684\u4f5c\u7528\u8303\u56f4\u53d8\u5927"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-js"},"/*\n    \u5c06Object.prototype.toString.call() \u6539\u4e3a toString() \u8c03\u7528\n*/\nfunction uncurrying(fn) {\n    return function (...args) {\n        // \u8c03\u7528\u51fd\u6570\u539f\u578b\u4e0a\u9762\u7684call\u65b9\u6cd5\n        return (Function.prototype.call).call(fn, ...args)\n    }\n}\nlet toString = uncurrying(Object.prototype.toString);\nconsole.log(toString(1)) // [object Number]\n")),Object(c.b)("h2",{id:"\u56de\u8c03\u51fd\u6570"},"\u56de\u8c03\u51fd\u6570"),Object(c.b)("h3",{id:"\u540c\u6b65\u56de\u8c03\u51fd\u6570"},"\u540c\u6b65\u56de\u8c03\u51fd\u6570"),Object(c.b)("p",null,"\u5728\u5f53\u524d\u51fd\u6570\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5e76\u4e0d\u4f1a\u4ea7\u751f\u5f02\u6b65\u7684\u903b\u8f91\uff0c\u800c\u4e14\u53ef\u4ee5\u4fdd\u8bc1\u5f53\u524d\u4f20\u5165\u7684\u56de\u8c03\u51fd\u6570\uff0c\u4f1a\u5728\u51fd\u6570\u6267\u884c\u4e4b\u4e2d\u6267\u884c\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-js"},"function callback() {\n    console.log('cb')\n}\nfunction sync(cb) {\n    console.log(1)\n    cb();\n    console.log(2)\n}\nsync(callback)\n/*\n1\ncb\n2\n*/\n")),Object(c.b)("h3",{id:"\u5f02\u6b65\u56de\u8c03\u51fd\u6570"},"\u5f02\u6b65\u56de\u8c03\u51fd\u6570"),Object(c.b)("p",null,"\u5f53\u524d\u7684\u56de\u8c03\u51fd\u6570\u4f1a\u5728\uff0c\u5f53\u524d\u51fd\u6570\u6267\u884c\u4e4b\u540e\u518d\u6267\u884c"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-js"},"function callback() {\n    console.log('cb')\n}\nfunction sync(cb) {\n    console.log(1)\n    setTimeout(cb, 1000);\n    console.log(2)\n}\nsync(callback)\n/*\n1\n2\ncb\n*/\n")),Object(c.b)("h2",{id:"\u5e76\u53d1"},"\u5e76\u53d1"),Object(c.b)("h3",{id:"after\u51fd\u6570"},"after\u51fd\u6570"),Object(c.b)("p",null,"\u5982\u4f55\u62ff\u5230\u4e24\u4e2a\u5f02\u6b65\u7684\u7ed3\u679c"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-js"},'const fs = require("fs");\nconst path = require("path");\n\nfunction after(nums, cb) {\n    let obj = {}  // \u95ed\u5305\u53d8\u91cf\n    return (key, value) => {\n        obj[key] = value  // \u5b58\u8d77\u6765\n        if(--nums === 0) {  // \u5230\u8fbe\u6b21\u6570\u540e\n            cb(obj)  // \u8fd4\u56de\u6700\u7ec8\u7ed3\u679c\n        }\n    }\n}\n\n// \u6b21\u6570 \u548c \u6700\u7ec8\u83b7\u5f97\u7ed3\u679c\u7684\u51fd\u6570\uff0c\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\uff0c\u7528\u6765\u83b7\u53d6\u5b58\u653e\u7684\u503c\nconst out = after(2, (data) => {\n    console.log(data);\n})\n\n// \u5f02\u6b65\u4ee3\u78011\nfs.readFile(path.resolve(__dirname, "./1.txt"), "utf-8", (err, data) => {\n  if (!err) {\n    out(\'1\',data)  // \u4f20\u503c\n  }\n});\n// \u5f02\u6b65\u4ee3\u78012\nfs.readFile(path.resolve(__dirname, "./2.txt"), "utf-8", (err, data) => {\n  if (!err) {\n    out(\'2\',data)  // \u4f20\u503c\n  }\n});\n')),Object(c.b)("h3",{id:"\u53d1\u5e03\u8ba2\u9605"},"\u53d1\u5e03\u8ba2\u9605"),Object(c.b)("p",null,"\u7528\u53d1\u5e03\u8ba2\u9605\u8fd9\u79cd\u6a21\u5f0f\u6765\u6a21\u62df\u521a\u521a\u4e0a\u9762\u7684\u60c5\u51b5"),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},"\u5904\u7406\u5f02\u6b65\u5e76\u53d1"),Object(c.b)("li",{parentName:"ol"},"\u590d\u6742\u903b\u8f91\u89e3\u8026")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-js"},'const fs = require("fs");\nconst path = require("path");\n\nlet obj = {}\nlet event = {\n    arr: [],\n    on(fn) {\n        this.arr.push(fn);\n    },\n    emit(key, value) {\n        obj[key] = value;\n        this.arr.forEach(fn => fn(obj));  // \u8ba2\u9605\u7684\u65f6\u5019\uff0c\u8fdb\u884c\u8c03\u7528\n    }\n}\n\nevent.on((data) => {\n    // \u53d1\u5e03\u4e24\u6b21\u6253\u5370\u6700\u7ec8\u7ed3\u679c\n    if (Object.keys(obj).length === 2) {\n        console.log(data)\n    }\n})\n\nfs.readFile(path.resolve(__dirname, "./1.txt"), "utf-8", (err, data) => {\n  if (!err) {\n    event.emit(\'1\',data)  // \u7b2c\u4e00\u6b21\u53d1\u5e03\n  }\n});\nfs.readFile(path.resolve(__dirname, "./2.txt"), "utf-8", (err, data) => {\n  if (!err) {\n    event.emit(\'2\',data)  // \u7b2c\u4e8c\u6b21\u53d1\u5e03\n  }\n});\n')),Object(c.b)("p",null,"// TODO: \u5b8c\u6574\u7248\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f  on emit off once listents"),Object(c.b)("h2",{id:"\u5176\u4ed6"},"\u5176\u4ed6"),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"\u4e0e\u53d1\u5e03\u8ba2\u9605\u4e0d\u540c\u7684\u662f\uff0c\u89c2\u5bdf\u8005\u662f\u88ab\u52a8\u89e6\u53d1\u7684\u3002\u8ba2\u9605\u662f\u4e3b\u52a8\u89e6\u53d1\u7684\u3002\n\u8fd9\u90e8\u5206\u5185\u5bb9\u4e0e\u5f02\u6b65\u65e0\u5173\uff0c\u4e3a\u4e86\u66f4\u597d\u7684\u533a\u5206 \u53d1\u5e03\u8ba2\u9605 \u4e0e \u89c2\u5bdf\u8005\u6a21\u5f0f")),Object(c.b)("h3",{id:"\u89c2\u5bdf\u8005\u6a21\u5f0f"},"\u89c2\u5bdf\u8005\u6a21\u5f0f"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-js"},"class Boby{\n    constructor(name){\n        this.name = name;\n        this.state = '\u5b9d\u5b9d\u5f00\u5fc3';\n        this.observer = [];\n    }\n\n    setState(newState) {\n        this.state = newState;  // \u89c2\u5bdf\u8005\u66f4\u6539\u72b6\u6001\u7684\u65f6\u5019\u8c03\u7528\u51fd\u6570\u3002\u53d1\u5e03\u8ba2\u9605\u662f\u5728\u8ba2\u9605\u65f6\u5019\u8c03\u7528\u51fd\u6570\n        this.observer.forEach(o => o.update(this))\n    }\n\n    attach(o) {\n        this.observer.push(o);  // \u53d1\u5e03\u51fd\u6570\n    }\n}\n\nclass Observer{\n    constructor(name) {\n        this.name = name;\n    }\n\n    update(body) {\n        console.log(this.name, body.state)  // \u89c2\u5bdf\u8005\u83b7\u5f97\u6700\u65b0\u7684\u4fe1\u606f\n    }\n}\n\nconst body = new Boby('\u5b9d\u5b9d');\nconst dad = new Observer('\u7238\u7238');\nconst mom = new Observer('\u5988\u5988');\nbody.attach(dad)\nbody.attach(mom)\nbody.setState('\u5b9d\u5b9d\u4f24\u5fc3')\n/*\n\u7238\u7238 \u5b9d\u5b9d\u4f24\u5fc3\n\u5988\u5988 \u5b9d\u5b9d\u4f24\u5fc3\n*/\n")))}u.isMDXComponent=!0},187:function(n,e,t){"use strict";t.d(e,"a",(function(){return u})),t.d(e,"b",(function(){return f}));var r=t(0),a=t.n(r);function c(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function l(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach((function(e){c(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function i(n,e){if(null==n)return{};var t,r,a=function(n,e){if(null==n)return{};var t,r,a={},c=Object.keys(n);for(r=0;r<c.length;r++)t=c[r],e.indexOf(t)>=0||(a[t]=n[t]);return a}(n,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(r=0;r<c.length;r++)t=c[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}var b=a.a.createContext({}),s=function(n){var e=a.a.useContext(b),t=e;return n&&(t="function"==typeof n?n(e):l(l({},e),n)),t},u=function(n){var e=s(n.components);return a.a.createElement(b.Provider,{value:e},n.children)},p={inlineCode:"code",wrapper:function(n){var e=n.children;return a.a.createElement(a.a.Fragment,{},e)}},d=a.a.forwardRef((function(n,e){var t=n.components,r=n.mdxType,c=n.originalType,o=n.parentName,b=i(n,["components","mdxType","originalType","parentName"]),u=s(t),d=r,f=u["".concat(o,".").concat(d)]||u[d]||p[d]||c;return t?a.a.createElement(f,l(l({ref:e},b),{},{components:t})):a.a.createElement(f,l({ref:e},b))}));function f(n,e){var t=arguments,r=e&&e.mdxType;if("string"==typeof n||r){var c=t.length,o=new Array(c);o[0]=d;var l={};for(var i in e)hasOwnProperty.call(e,i)&&(l[i]=e[i]);l.originalType=n,l.mdxType="string"==typeof n?n:r,o[1]=l;for(var b=2;b<c;b++)o[b]=t[b];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"}}]);